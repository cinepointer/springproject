<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시글 상세</title>
    <link rel="stylesheet" href="/css/boardDetail.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="/js/boardDetail.js" defer></script>
</head>
<body>
<div th:replace="~{fragment/header :: headerFragment}"></div>
<div class="container">
    <div class="board-detail">
        <h2 th:text="${board.boardTitle}">게시글 제목</h2>
        <p>
            작성자: <span th:text="${board.userId}">작성자</span> /
            작성일: <span th:text="${board.boardRegDate}">작성일</span>
        </p>
        <p class="white-space-pre-wrap" th:text="${board.boardContent}">게시글 내용</p>
        <div th:if="${session.userNum == board.userNum}">
            <div th:if="${session.userId == board.userId}">
		    	<a th:href="@{/board/updateForm/{boardNum}(boardNum=${board.boardNum})}">[수정]</a>
		    	<a th:href="@{/board/delete/{boardNum}(boardNum=${board.boardNum})}" onclick="return confirm('정말 삭제하시겠습니까?');">[삭제]</a>
			</div>

        </div>
    </div>

    <div class="comments">
        <h4>댓글</h4>
        <div th:each="comment : ${comment}" th:id="'comment-' + ${comment.commentNum}">
            <p>
                <strong th:text="${comment.userId}">작성자</strong>
                (<span th:text="${comment.commentTime}">작성시간</span>)
                <span th:if="${session.userId == comment.userId}">
                    <a href="javascript:void(0);" th:onclick="'showEditForm(' + ${comment.commentNum} + ');'">[수정]</a>
                    <a th:href="@{'/board/commentDelete/' + ${comment.commentNum} + '/' + ${board.boardNum}}">[삭제]</a>
                </span>
            </p>
            <p class="white-space-pre-wrap" th:text="${comment.commentContent}" th:id="'content-' + ${comment.commentNum}">댓글 내용</p>

            <div th:id="'editForm-' + ${comment.commentNum}" class="edit-form">
                <form th:action="@{/board/commentEdit}" method="post">
                    <input type="hidden" name="commentNum" th:value="${comment.commentNum}">
                    <input type="hidden" name="boardNum" th:value="${board.boardNum}">
                    <textarea name="commentContent" rows="3" th:text="${comment.commentContent}"></textarea>
                    <button type="submit">수정하기</button>
                    <button type="button" class="cancel-edit">취소</button>
                </form>
            </div>
        </div>

        <div>
            <form action="/board/comment" method="post">
                <textarea name="commentContent" rows="3" placeholder="댓글을 작성해주세요." required></textarea>
                <input type="hidden" name="boardNum" th:value="${board.boardNum}">
                <button type="submit">댓글 등록</button>
                <div style="margin-top: 20px;">
				    <a th:href="@{/board/list}" class="btn">[목록으로]</a>
				</div>
            </form>
        </div>
    </div>
</div>
<div th:replace="~{fragment/footer :: footerFragment}"></div>
</body>
</html>
